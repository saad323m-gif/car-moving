<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>ูุธุงู ุฅุฏุงุฑุฉ ุญุฑูุฉ ูุนูุฏุฉ ุงูุณูุงุฑุงุช</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Manifest PWA -->
  <link rel="manifest" href="manifest.json" />

  <!-- ุฃููููุฉ ุงููููุน -->
  <link rel="icon" type="image/png" href="logo.png" />

  <!-- ููุท CSS -->
  <link rel="stylesheet" href="styles.css" />

  <!-- ููุชุง PWA ูุฃูููู -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <link rel="apple-touch-icon" href="logo.png" />

</head>
<body>

  <!-- ุฒุฑ ุชุญุฏูุซ ูุฏูู ูู ุงูููุฏุฑ -->
  <header class="app-header">
    <div class="header-left">
      <img src="logo.png" alt="Logo" class="logo" />
      <div>
        <h1 class="app-title">ูุธุงู ุฅุฏุงุฑุฉ ุญุฑูุฉ ูุนูุฏุฉ ุงูุณูุงุฑุงุช</h1>
        <p class="app-subtitle">ุตูุงุญูุงุช (ูุทูุฑ ุงููุธุงูุ ูุฏูุฑุ ูุดุฑูุ ุนุถู)</p>
      </div>
    </div>
    <div class="header-right">
      <button id="refreshAppBtn" class="btn btn-secondary">
        ๐ ุชุญุฏูุซ
      </button>
      <button id="logoutBtn" class="btn btn-danger" style="display:none;">
        ุชุณุฌูู ุฎุฑูุฌ
      </button>
    </div>
  </header>

  <!-- ุดุงุดุฉ ุงูุชุญููู ุงูุณุฑูุน -->
  <div id="loadingOverlay" class="overlay overlay-visible">
    <div class="overlay-content">
      <div class="loader"></div>
      <p>ุฌุงุฑู ุชุญููู ุงููุธุงู...</p>
    </div>
  </div>

  <!-- ุดุงุดุฉ ุงูุฏุฎูู / ุงูุชุณุฌูู -->
  <main id="authView" class="auth-view">
    <div class="card auth-card">
      <h2 class="card-title">ุชุณุฌูู ุงูุฏุฎูู</h2>
      <div class="tabs">
        <button class="tab-button tab-active" data-auth-tab="login">ุฏุฎูู</button>
        <button class="tab-button" data-auth-tab="register">ุชุณุฌูู ุฌุฏูุฏ</button>
      </div>

      <!-- ูููุฐุฌ ุงูุฏุฎูู -->
      <form id="loginForm" class="form" data-tab="login">
        <div class="form-group">
          <label for="loginUsername">ุงุณู ุงููุณุชุฎุฏู</label>
          <input type="text" id="loginUsername" required minlength="4" />
        </div>
        <div class="form-group">
          <label for="loginPassword">ูููุฉ ุงููุฑูุฑ</label>
          <input type="password" id="loginPassword" required minlength="6" />
        </div>
        <button type="submit" class="btn btn-primary btn-full">ุฏุฎูู</button>
      </form>

      <!-- ูููุฐุฌ ุงูุชุณุฌูู -->
      <form id="registerForm" class="form hidden" data-tab="register">
        <div class="form-group">
          <label for="registerFullName">ุงุณู ุงูุนุถู</label>
          <input type="text" id="registerFullName" required />
        </div>
        <div class="form-group">
          <label for="registerUsername">ุงุณู ุงููุณุชุฎุฏู (4 ุฃุญุฑู ุนูู ุงูุฃูู)</label>
          <input type="text" id="registerUsername" required minlength="4" />
        </div>
        <div class="form-group">
          <label for="registerPassword">ูููุฉ ุงููุฑูุฑ (6 ุฎุงูุงุช ุนูู ุงูุฃูู)</label>
          <input type="password" id="registerPassword" required minlength="6" />
        </div>
        <div class="form-group">
          <label for="registerPhone">ูุณููุฉ ุงูุงุชุตุงู (10 ุฃุฑูุงู)</label>
          <input type="tel" id="registerPhone" pattern="[0-9]{10}" required />
        </div>
        <p class="hint-text">
          ุฃูู ุนุถู ูุชู ุชุณุฌููู ูู ุงููุธุงู ุณููููุญ ุตูุงุญูุฉ <strong>ูุทูุฑ ุงููุธุงู</strong> ุชููุงุฆููุง (ุจุฏูู ุฃู ุชูููู ุนูู ุงููุงุฌูุฉ).
        </p>
        <button type="submit" class="btn btn-primary btn-full">ุชุณุฌูู</button>
      </form>

      <p id="authMessage" class="message"></p>
    </div>
  </main>

  <!-- ูุงุฌูุฉ ุงููุธุงู ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู -->
  <main id="appView" class="app-view hidden">

    <!-- ุดุฑูุท ูุนูููุงุช ุงููุณุชุฎุฏู -->
    <section class="user-bar">
      <div>
        <span id="currentUserName"></span> -
        <span id="currentUserRoleBadge" class="role-badge"></span>
      </div>
      <div>
        <input type="search" id="globalSearchInput" placeholder="ุจุญุซ ูู ุฌููุน ุงูุฃูุณุงู..." />
      </div>
    </section>

    <!-- ุชุจููุจุงุช ุงูุฃูุณุงู -->
    <nav class="tabs main-tabs">
      <button class="tab-button main-tab-button tab-active" data-main-tab="movements">ุงูุญุฑูุฉ</button>
      <button class="tab-button main-tab-button" data-main-tab="custody">ุงูุนูุฏุฉ</button>
      <button class="tab-button main-tab-button" data-main-tab="fleet">ุงูุฃุณุทูู</button>
      <button class="tab-button main-tab-button" data-main-tab="members">ุงูุฃุนุถุงุก</button>
      <button class="tab-button main-tab-button" data-main-tab="stats">ุงูุฅุญุตุงุฆูุงุช</button>
    </nav>

    <!-- ูุณู ุญุฑูุฉ ุงูุณูุงุฑุงุช -->
    <section id="movementsTab" class="tab-content">
      <div class="tab-header">
        <h2>ุญุฑูุฉ ุงูุณูุงุฑุงุช</h2>
        <button id="addMovementBtn" class="btn btn-primary">โ ุฅุถุงูุฉ ุญุฑูุฉ</button>
      </div>

      <div id="movementFormContainer" class="card collapsible hidden"></div>

      <div id="movementsList" class="accordion-list"></div>
    </section>

    <!-- ูุณู ุงูุนูุฏุฉ -->
    <section id="custodyTab" class="tab-content hidden">
      <div class="tab-header">
        <h2>ุงูุนูุฏุฉ</h2>
        <button id="addCustodyBtn" class="btn btn-primary">โ ุฅุถุงูุฉ ุนูุฏุฉ</button>
      </div>

      <div id="custodyFormContainer" class="card collapsible hidden"></div>

      <div id="custodyList" class="accordion-list"></div>
    </section>

    <!-- ูุณู ุงูุฃุณุทูู -->
    <section id="fleetTab" class="tab-content hidden">
      <div class="tab-header">
        <h2>ุงูุฃุณุทูู</h2>
        <button id="addFleetBtn" class="btn btn-primary">โ ุฅุถุงูุฉ ุณูุงุฑุฉ</button>
      </div>

      <div id="fleetFormContainer" class="card collapsible hidden"></div>

      <div id="fleetList" class="accordion-list"></div>
    </section>

    <!-- ูุณู ุงูุฃุนุถุงุก -->
    <section id="membersTab" class="tab-content hidden">
      <div class="tab-header">
        <h2>ุงูุฃุนุถุงุก</h2>
        <button id="addMemberBtn" class="btn btn-primary">โ ุฅุถุงูุฉ ุนุถู</button>
      </div>

      <div id="memberFormContainer" class="card collapsible hidden"></div>

      <div id="membersList" class="accordion-list"></div>
    </section>

    <!-- ูุณู ุงูุฅุญุตุงุฆูุงุช -->
    <section id="statsTab" class="tab-content hidden">
      <div class="tab-header">
        <h2>ุงูุฅุญุตุงุฆูุงุช</h2>
      </div>

      <div class="card">
        <div class="form-inline">
          <label for="statsPeriod">ุงููุชุฑุฉ:</label>
          <select id="statsPeriod">
            <option value="day">ุงูููู</option>
            <option value="week">ุงูุฃุณุจูุน</option>
            <option value="month">ุงูุดูุฑ</option>
            <option value="year">ุงูุณูุฉ</option>
            <option value="all">ูู ุงููุฏุฉ</option>
          </select>
          <button id="loadStatsBtn" class="btn btn-secondary">ุนุฑุถ</button>
          <button id="printStatsBtn" class="btn btn-secondary">๐จ ุทุจุงุนุฉ</button>
        </div>
        <div id="statsContent"></div>
      </div>
    </section>

  </main>

  <!-- ููุชุฑ -->
  <footer class="app-footer">
    <p>
      ุฌููุน ุงูุญููู ูุญููุธุฉ &copy;
      <span id="currentYear"></span> -
      ุชู ุงูุชุทููุฑ ูุงูุจุฑูุฌุฉ ุจูุงุณุทุฉ MOHAMED SAAD
    </p>
  </footer>

  <!-- ููุชุจุงุช Firebase CDN (Modular SDK) -->
  <script type="module" src="firebase.js"></script>
  <script type="module" src="auth.js"></script>
  <script type="module" src="roles.js"></script>
  <script type="module" src="movements.js"></script>
  <script type="module" src="custody.js"></script>
  <script type="module" src="fleet.js"></script>
  <script type="module" src="members.js"></script>
  <script type="module" src="stats.js"></script>
  <script type="module" src="search.js"></script>
  <script type="module" src="app.js"></script>

</body>
</html>
